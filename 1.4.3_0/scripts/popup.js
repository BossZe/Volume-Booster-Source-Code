var Localizations=function(){for(var e=$("[datatype=i18n]"),t=e.length,a=0;a<t;a++){var o=e[a].id;$(e[a]).html(Methods.getLocalizedText(o))}};Localizations.infoText=function(){var e=$("#powerIcon");e.on("mouseover",(function(){var t=Methods.getLocalizedText("captureCurrentTab");e.attr("title",t)})),"true"==Methods.load("info")&&$("#wrapper").on("mousemove",(function(e){var t="";switch(e.target.id){case"threshold":t=Methods.getLocalizedText("thresholdInfo");break;case"release":t=Methods.getLocalizedText("releaseInfo");break;case"attack":t=Methods.getLocalizedText("attackInfo");break;case"ratio":t=Methods.getLocalizedText("ratioInfo");break;case"knee":t=Methods.getLocalizedText("kneeInfo");break;case"twenty":t=Methods.getLocalizedText("twentyInfo");break;case"fifty":t=Methods.getLocalizedText("fiftyInfo");break;case"oneHundred":t=Methods.getLocalizedText("oneHundredInfo");break;case"twoHundred":t=Methods.getLocalizedText("twoHundredInfo");break;case"fiveHundred":t=Methods.getLocalizedText("fiveHundredInfo");break;case"oneThousand":case"twoThousand":t=Methods.getLocalizedText("oneThousandInfo");break;case"fiveThousand":t=Methods.getLocalizedText("fiveThousandInfo");break;case"tenThousand":t=Methods.getLocalizedText("tenThousandInfo");break;case"twentyThousand":t=Methods.getLocalizedText("twentyThousandInfo");break;case"resetLabel":t=Methods.getLocalizedText("resetInfo");break;case"savePresetLabel":t=Methods.getLocalizedText("savePresetInfo");break;case"loadPresetLabel":t=Methods.getLocalizedText("loadPresetInfo");break;case"saveBtn":t=Methods.getLocalizedText("saveBtnInfo");break;case"monoBtn":t=Methods.getLocalizedText("monoInfo");break;case"panFader":t=Methods.getLocalizedText("panFaderLabel");break;case"phaseBtn":t=Methods.getLocalizedText("phaseInfo");break;case"advancedLabel":t=Methods.getLocalizedText("advancedInfo");break;default:t=""}$("#info").html(t)})).on("mouseout",(function(){$("#info").html(""),$("#valInfo").html("")}))};var Instance=function(){};Instance.isInstance=function(){if("false"==Methods.load("instance"))return window.onunload=function(){Methods.save("instance","false"),Methods.setIcon("off")},Methods.save("instance","true"),!0};var BackgroundListener=function(){chrome.runtime.onMessage.addListener((function(e){"analyserModule"===e.type&&analyserModule(e),"chorusSettings"===e.type&&($("#chorusRate").val(e.rate)[0].updateBg(),$("#chorusDepth").val(e.depth)[0].updateBg(),$("#back").val(e.feedback)[0].updateBg(),$("#chorusDelay").val(e.delay)[0].updateBg(),Popup.updateChorusNumeric()),"convolverSettings"===e.type&&($("#convolverWetLevel").val(e.wetLevel)[0].updateBg(),$("#convolverDryLevel").val(e.dryLevel)[0].updateBg(),$("#convolverHighCut").val(e.highCut)[0].updateBg(),$("#convolverLowCut").val(e.lowCut)[0].updateBg(),Popup.updateConvolverNumeric()),"pitchSettings"==e.type&&($("#pitch").val(e.pitch)[0].updateBg(),$("#pitchCents").val(e.cents)[0].updateBg(),Popup.updatePitchNumeric()),"volumeSetting"==e.type&&$("#volume").val(e.value)[0].updateBg(),"eqSettings"==e.type&&($("#twenty").val(e.twenty)[0].updateBg(),$("#fifty").val(e.fifty)[0].updateBg(),$("#oneHundred").val(e.oneHundred)[0].updateBg(),$("#twoHundred").val(e.twoHundred)[0].updateBg(),$("#fiveHundred").val(e.fiveHundred)[0].updateBg(),$("#oneThousand").val(e.oneThousand)[0].updateBg(),$("#twoThousand").val(e.twoThousand)[0].updateBg(),$("#fiveThousand").val(e.fiveThousand)[0].updateBg(),$("#tenThousand").val(e.tenThousand)[0].updateBg(),$("#twentyThousand").val(e.twentyThousand)[0].updateBg()),"limiterSettings"==e.type&&($("#threshold").val(e.threshold)[0].updateBg(),$("#attack").val(e.attack)[0].updateBg(),$("#release").val(e.release)[0].updateBg(),$("#ratio").val(e.ratio)[0].updateBg(),$("#knee").val(e.knee)[0].updateBg(),Popup.updateLimiterNumeric()),"powerOff"==e.type&&chrome.tabs.query({active:!0,currentWindow:!0},(function(e){Power.Off(),Popup.channelModal(e[0].title,"Stream Unavailable")})),"displayFaders"==e.type&&Faders.displayFaders()}))},ButtonEvents=function(){$("#darkThemeLabel").on("click",(function(){Theme.makeDark("#mainPanel")})),$("#lightThemeLabel").on("click",(function(){Theme.makeLight("#mainPanel")})),$("#gotoTab").on("click",(function(){chrome.tabs.get(Number(Methods.load("id")),(function(e){chrome.tabs.highlight({windowId:e.windowId,tabs:e.index},(function(){}))}))})),$("#editInBackground").on("click",(function(){chrome.tabs.get(Number(Methods.load("id")),(function(e){Popup.showModules(),$("#title").html(e.title),Popup.advancedInit(),Mono.init(),Phased.init()}))})),$("#resetLabel").on("click",(function(){Methods.sendRuntime({type:"volume",value:1}),$("#volume").val(1)[0].updateBg(),"limiter"==TabHandler.isType()&&(Reset.resetLimiterVals(),Popup.sendLimiter(),Popup.updateLimiterNumeric()),"eq"==TabHandler.isType()&&(Reset.resetEqVals(),Popup.sendEq()),"chorus"==TabHandler.isType()&&(Reset.resetChorusVals(),Popup.sendChorus(),Popup.updateChorusNumeric()),"convolver"==TabHandler.isType()&&(Reset.resetConvolverVals(),Popup.sendConvolver(),Popup.updateConvolverNumeric()),"pitch"==TabHandler.isType()&&(Reset.resetPitchVals(),Popup.sendPitch(),Popup.updatePitchNumeric())})),$("#chorusRadio").on("click",(function(){Chorus.show()})),$("#convolverRadio").on("click",(function(){Convolver.show()})),$("#pitchRadio").on("click",(function(){Pitch.show()})),$("#advancedLabel").on("click",(function(){var e=$(".advanced");if(e.hasClass("disabled")){var t=$("#thresholdLabel");t.html(Methods.getLocalizedText("thresholdLabel")),t.html(Methods.get),e.removeClass("disabled"),Methods.save("advanced","true"),$("#advancedLabel").addClass("fg-green")}else Methods.save("advanced","false"),$("#thresholdLabel").html(Methods.getLocalizedText("dynamicsLabel")),$("#advancedLabel").removeClass("fg-green"),e.addClass("disabled")})),$("#limiterRadio").on("click",(function(){Limiter.show()})),$("#eqRadio").on("click",(function(){Equalizer.show()})),$("#powerIcon").on("click",(function(){Power.powerIcon()})),$("#power").on("click",(function(){Power.toggle()})),$("#presets").on("change",(function(e){Preset.presetsChangeHandler(e.target.value)})),$("#delete").on("click",(function(){Methods.save("volumePresetVal",1),"limiter"==TabHandler.isType()&&Preset.deletePreset("limiter"),"eq"==TabHandler.isType()&&Preset.deletePreset("eq"),"chorus"==TabHandler.isType()&&Preset.deletePreset("chorus"),"convolver"==TabHandler.isType()&&Preset.deletePreset("convolver"),"pitch"==TabHandler.isType()&&Preset.deletePreset("pitch"),Popup.showSave()})),$("#savePresetLabel").on("click",(function(){"limiter"==TabHandler.isType()&&Preset.savePreset("limiterPreset"),"eq"==TabHandler.isType()&&Preset.savePreset("eqPreset"),"chorus"==TabHandler.isType()&&Preset.savePreset("chorusPreset"),"convolver"==TabHandler.isType()&&Preset.savePreset("convolverPreset"),"pitch"==TabHandler.isType()&&Preset.savePreset("pitchPreset"),Popup.showLoad()})),$("#optionsPage").on("click",(function(){chrome.tabs.create({url:"html/options.html"})})),$("#loadPresetLabel").on("click",(function(){"limiter"==TabHandler.isType()&&Preset.loadPreset("limiterPreset"),"eq"==TabHandler.isType()&&Preset.loadPreset("eqPreset"),"chorus"==TabHandler.isType()&&Preset.loadPreset("chorusPreset"),"convolver"==TabHandler.isType()&&Preset.loadPreset("convolverPreset"),"pitch"==TabHandler.isType()&&Preset.loadPreset("pitchPreset")})),$("#bypass").on("click",(function(){Bypass.toggle()})),$("#monoBtn").on("click",(function(){Mono.toggle()})),$("#phaseBtn").on("click",(function(){Phased.toggle()}));var e=$("#panFader");e.knob({fgColor:"rgba(118, 241, 108, 1)",angleOffset:-125,angleArc:250,min:-1,max:1,thickness:".3",value:Methods.load("pan"),step:.01,width:"35",height:"35",bgColor:"#585858",change:function(e){Methods.sendRuntime({type:"pan",value:e.toFixed(2)})},release:function(e){Methods.save("pan",e)}}),$("#panDiv").on("dblclick",(function(){e.val(0).trigger("change"),Methods.sendRuntime({type:"pan",value:0})}))},Popup=function(){new Localizations,Instance.isInstance()?(new BackgroundListener,new ButtonEvents,$("#version").html(Methods.version().version),$("#panFader").val(Methods.load("pan")||0).trigger("change"),Localizations.infoText(),Theme.loadSelected(),chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t=function(){Methods.save("id",e[0].id),Methods.sendRuntime({type:"powerOn",value:e[0]}),Power.visualOn(e[0])};"true"==Methods.load("power")?(chrome.runtime.getBackgroundPage((function(e){void 0===e.capturedTabObj.stream&&t();var a=$("#volume");a.val(e.capturedTabObj.volumeGainNode.gain.value)[0].updateBg(),a.css("opacity","1")})),Number(Methods.load("id"))==e[0].id?Power.initOn():"true"==Methods.load("autoOpen")?(Power.active(),$("#powerIcon").click()):(Methods.sendRuntime({type:"sendAnalyserStream"}),Power.active())):chrome.runtime.getBackgroundPage((function(e){void 0===e.capturedTabObj.stream&&t()}))}))):($("body").remove(),$("html").html(Methods.getLocalizedText("instanceOpenAlready")).css("padding","10px"))};Popup.channelModal=function(e,t){$("#modalBody").html(e),$("#modalTitle").html(t)},Popup.setTitle=function(e){chrome.tabs.get(Number(e),(function(e){$("#title").text(e.title)}))},Popup.hideModules=function(){$("#visualizer").hide(),$("#modalOff").addClass("unhide"),$(".active").css({filter:"blur(1px)"}),$("#volume[type=range]").prop("disabled",!0)},Popup.showModules=function(){$("#visualizer").show(),Faders.displayFaders(),$("#modalOff").removeClass("unhide"),$("#volumeDiv").removeClass("disableInput"),$("input[type=range]").prop("disabled",!1),$(".active").css({filter:"blur(0px)"})},Popup.showLoad=function(){$("#savePresetLabel").addClass("hidden"),$("#delete").removeClass("hidden"),$("#loadPresetLabel").removeClass("hidden")},Popup.showSave=function(){$("#loadPresetLabel").addClass("hidden"),$("#delete").addClass("hidden"),$("#savePresetLabel").removeClass("hidden")},Popup.advancedInit=function(){var e=$("#thresholdLabel");"true"==Methods.isAdvanced()?(e.html(Methods.getLocalizedText("thresholdLabel")),$("#advancedLabel").addClass("fg-green"),$(".advanced").removeClass("disabled")):e.html(Methods.getLocalizedText("dynamicsLabel"))},Popup.updateLimiterNumeric=function(){$("#thresholdVal").html($("#threshold").val()),$("#attackVal").html($("#attack").val()),$("#releaseVal").html($("#release").val()),$("#kneeVal").html($("#knee").val()),$("#ratioVal").html($("#ratio").val())},Popup.updateChorusNumeric=function(){$("#chorusDelayVal").html($("#chorusDelay").val()),$("#backVal").html($("#back").val()),$("#chorusRateVal").html($("#chorusRate").val()),$("#chorusDepthVal").html($("#chorusDepth").val())},Popup.updateConvolverNumeric=function(){$("#convolverDryLevelVal").html($("#convolverDryLevel").val()),$("#convolverHighCutVal").html($("#convolverHighCut").val()),$("#convolverLowCutVal").html($("#convolverLowCut").val()),$("#convolverWetLevelVal").html($("#convolverWetLevel").val())},Popup.updatePitchNumeric=function(){$("#pitchVal").html($("#pitch").val()),$("#pitchCentsVal").html($("#pitchCents").val())},Popup.sendChorus=function(){Methods.sendRuntime({type:"chorusRate",value:$("#chorusRate").val()}),Methods.sendRuntime({type:"chorusDepth",value:$("#chorusDepth").val()}),Methods.sendRuntime({type:"back",value:$("#back").val()}),Methods.sendRuntime({type:"chorusDelay",value:$("#chorusDelay").val()})},Popup.sendConvolver=function(){Methods.sendRuntime({type:"convolverWetLevel",value:$("#convolverWetLevel").val()}),Methods.sendRuntime({type:"convolverDryLevel",value:$("#convolverDryLevel").val()}),Methods.sendRuntime({type:"convolverHighCut",value:$("#convolverHighCut").val()}),Methods.sendRuntime({type:"convolverLowCut",value:$("#convolverLowCut").val()})},Popup.sendPitch=function(){var e=$("#pitch").val(),t=$("#pitchCents").val();Methods.sendRuntime({type:"pitch",value:e}),Methods.sendRuntime({type:"pitchCents",value:t})},Popup.sendLimiter=function(){Methods.sendRuntime({type:"threshold",value:$("#threshold").val()}),Methods.sendRuntime({type:"ratio",value:$("#ratio").val()}),Methods.sendRuntime({type:"knee",value:$("#knee").val()}),Methods.sendRuntime({type:"release",value:$("#release").val()}),Methods.sendRuntime({type:"attack",value:$("#attack").val()})},Popup.sendEq=function(){Methods.sendRuntime({type:"twenty",value:$("#twenty").val()}),Methods.sendRuntime({type:"fifty",value:$("#fifty").val()}),Methods.sendRuntime({type:"oneHundred",value:$("#oneHundred").val()}),Methods.sendRuntime({type:"twoHundred",value:$("#twoHundred").val()}),Methods.sendRuntime({type:"fiveHundred",value:$("#fiveHundred").val()}),Methods.sendRuntime({type:"oneThousand",value:$("#oneThousand").val()}),Methods.sendRuntime({type:"twoThousand",value:$("#twoThousand").val()}),Methods.sendRuntime({type:"fiveThousand",value:$("#fiveThousand").val()}),Methods.sendRuntime({type:"tenThousand",value:$("#tenThousand").val()}),Methods.sendRuntime({type:"twentyThousand",value:$("#twentyThousand").val()})};var init=new Popup;